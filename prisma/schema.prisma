// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

generator client {
  provider = "prisma-client-js"
}

model Profile {
  id             String   @id @unique @default(uuid())
  nickname       String?
  name           String?
  email          String   @unique
  imageUrl       String?
  CCCount        Int?
  admin          Boolean?
  supporter      Boolean?
  joindate       DateTime @default(now())
  discord        String?
  favoriteGame   Games?
  bio            String?  @db.VarChar(250)
  points         Int?
  pointsRanking  Ranking?
  event          Int?
  eventRanking   Int?
  hashedPassword String?
  profileBanner  String?
  Replays        Replay[]
}

// example:  "EASY/9999.9999.9999/123+NORMAL/9999.9999.9999/345+HARD/9999.9999.9999/677+LUNATIC/9999.9999.9999/444";
// use parseScoreString function to get ScoreObject type
model Ranking {
  total               Int?
  EOSD                String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  PCB                 String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  IN                  String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  POFV                String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  MOF                 String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  SA                  String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  UFO                 String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  GFW                 String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  TD                  String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  DDC                 String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  LOLK                String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  HSIFS               String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  WBAWC               String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  UM                  String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  UDOALG              String?  @default("EASY/0/0+NORMAL/0/0+HARD/0/0+LUNATIC/0/0+EXTRA/0/0")
  userIdRankingPoints String   @unique
  Profile             Profile? @relation(fields: [userIdRankingPoints], references: [id])
}

model Replay {
  replayId     String        @id @default(cuid())
  player       String?
  character    String?
  rank         String?
  shottype     String?
  stage        String?
  stage_score  String?
  game         Int?
  date         String?
  rpy_name     String?
  points       Int?
  acceptedBy   String?
  filePath     String?
  comment      String?
  hash         String?       @unique
  uploadedDate DateTime?     @default(now())
  fileDate     String?
  achievement  Achievement?
  status       ReplayStatus?

  userId  String?
  Profile Profile? @relation(fields: [userId], references: [id])

  @@index([userId])
}

enum ReplayStatus {
  NEW
  VERIFIED
  REJECTED
}

enum Achievement {
  CC
  NM
  NB
  NMNB
  NNN
  NNNN
}

enum Games {
  EOSD
  PCB
  IN
  INA
  INB
  POFV
  MOF
  SA
  UFO
  GFW
  TD
  DDC
  LOLK
  HSIFS
  WBAWC
  UM
  UDOALG
}
