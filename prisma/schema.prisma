// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

generator client {
  provider = "prisma-client-js"
}

model Profile {
  id               String   @id @default(uuid())
  nickname         String?
  name             String?
  email            String   @unique
  imageUrl         String?
  scoreRank        Int?
  achievementsRank Int?
  CCCount          Int?
  admin            Boolean?
  supporter        Boolean?
  joindate         DateTime @default(now())
  discord          String?
  favoriteGame     Games?
  bio              String?  @db.VarChar(250)
  totalPoints      Int?
  totalScore       Int?
  eventPoints      Int?
  hashedPassword   String?
  profileBanner    String?
  Replays          Replay[]
  PointsRank       Ranking  @relation(fields: [id], references: [user])

  @@index([id])
}

model Replay {
  replayId     String       @id @default(cuid())
  player       String
  character    String?
  rank         String?
  shottype     String?
  stage        String?
  slow_rate    Int?
  stage_score  Int?
  frame_count  Int?
  game         Games
  date         String?
  date_on_file String?
  z_keys       Int?
  x_keys       Int?
  c_keys       Int?
  checksum     String?
  shift        Int?
  rpy_name     String?
  points       Int?
  scorePoints  Int?
  acceptedBy   String
  filePath     String?
  comment      String?
  achievement  Achievement
  status       ReplayStatus

  Profile   Profile? @relation(fields: [profileId], references: [id])
  profileId String?

  @@index([profileId])
}

//example:  EASY-9999.9999.9999-ID/NORMAL-9999.9999.9999-ID/HARD-9999.9999.9999-ID/LUNATIC-9999.9999.9999-ID
model Ranking {
  user    String    @id
  score   Int?
  EOSD    String?   @db.Text
  PCB     String?   @db.Text
  IN      String?   @db.Text
  INA     String?   @db.Text
  INB     String?   @db.Text
  POFV    String?   @db.Text
  MOF     String?   @db.Text
  SA      String?   @db.Text
  UFO     String?   @db.Text
  GFW     String?   @db.Text
  TD      String?   @db.Text
  DDC     String?   @db.Text
  LOLK    String?   @db.Text
  HSIFS   String?   @db.Text
  WBAWC   String?   @db.Text
  UM      String?   @db.Text
  UDoALG  String?   @db.Text
  Profile Profile[]
}

enum ReplayStatus {
  NEW
  VERIFIED
  REJECTED
}

enum Achievement {
  CC
  NM
  NB
  NMNB
  NNN
  NNNN
}

enum Games {
  EOSD
  PCB
  IN
  INA
  INB
  POFV
  MOF
  SA
  UFO
  GFW
  TD
  DDC
  LOLK
  HSIFS
  WBAWC
  UM
  UDoALG
}
